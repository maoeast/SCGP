# CLAUDE.md - Agent Configuration & Rules

## 1. ğŸš¨ æ ¸å¿ƒåè®® (CORE PROTOCOLS)
> **æœ€é«˜ä¼˜å…ˆçº§æŒ‡ä»¤**ï¼šåœ¨å¼€å§‹ä»»ä½•ä»»åŠ¡å‰ï¼Œ**å¿…é¡»**éµå¾ªä»¥ä¸‹æµç¨‹ã€‚

1.  **ä¸Šä¸‹æ–‡åŠ è½½ (Context Loading)**ï¼š
    *   **åŸºç¡€**: è¯»å–æ ¹ç›®å½•çš„ `PROJECT_CONTEXT.md`ã€‚
    *   **é‡æ„ (å…³é”®)**: ç”±äºé¡¹ç›®å¤„äºæ¶æ„é‡æ„é˜¶æ®µï¼Œ**å¿…é¡»é¢å¤–è¯»å–**:
        *   `E:\VSC\H5\SIC-ADS\é‡æ„å®æ–½æŠ€æœ¯è§„èŒƒ.md` (æ¶æ„ä¸çº¦æŸ)
        *   `E:\VSC\H5\SIC-ADS\docs\plans\2025-02-05-refactor-implementation-plan.md` (è¿›åº¦è¿½è¸ª)
2.  **çŠ¶æ€åŒæ­¥ (Sync)**ï¼šå¯¹æ¯” Context ä¸ Planï¼Œç¡®è®¤å½“å‰çš„ [å¼€å‘é˜¶æ®µ] å’Œ [å¾…åŠä»»åŠ¡]ã€‚
3.  **æ–‡æ¡£ç»´æŠ¤ (Maintenance)**ï¼šä»»åŠ¡ç»“æŸæ—¶ï¼Œå¿…é¡»åŒæ—¶æ›´æ–° `PROJECT_CONTEXT.md` (æ‘˜è¦) å’Œ `å®æ–½è®¡åˆ’.md` (è¯¦ç»†è¿›åº¦)ã€‚
4.  **å•ä¸€äº‹å®æ¥æº**ï¼šä»¥ `é‡æ„å®æ–½æŠ€æœ¯è§„èŒƒ.md` ä¸ºæœ€é«˜æŠ€æœ¯å‡†åˆ™ï¼Œå¿½ç•¥æ—§ä»£ç ä¸­çš„è®¾è®¡æ¨¡å¼ã€‚

## 2. ğŸ›  æŠ€æœ¯æ ˆè§„èŒƒ (TECH STACK)
- **Runtime**: Electron (Main/Renderer Process), Node.js
- **Frontend**: Vue 3 (Composition API, `<script setup>`), Vite, TailwindCSS
- **Backend/API**: Node.js, Express (åœ¨ Electron ç¯å¢ƒä¸­å¯èƒ½ä½œä¸ºæœ¬åœ°æœåŠ¡è¿è¡Œ)
- **Language**: TypeScript (Strict mode enabled)
- **State Management**: Pinia (æ¨è) æˆ– Vue Reactivity
- **Database**: Better-SQLite3 (å¦‚æ¶‰åŠ)

## 3. ğŸ—ï¸ æ„å»ºä¸è¿è¡Œ (COMMANDS)

### å¼€å‘ç¯å¢ƒ (Development)
> **æ³¨æ„**ï¼šä¼˜å…ˆä½¿ç”¨å¹¶å‘å¯åŠ¨å‘½ä»¤ï¼Œé¿å…å¤šç»ˆç«¯æ“ä½œã€‚

- **Electron (é¦–é€‰)**: `npm run electron:dev`
    - *è¡Œä¸º: å¹¶è¡Œå¯åŠ¨ Vite Server å’Œ Electron çª—å£ï¼Œæ”¯æŒçƒ­é‡è½½ (HMR)ã€‚*
- **Web Only (è°ƒè¯•UI)**: `npm run dev`
    - *è¡Œä¸º: ä»…å¯åŠ¨æµè§ˆå™¨æ¨¡å¼ï¼Œé€‚ç”¨äºè°ƒè¯•çº¯å‰ç«¯ UI é€»è¾‘ï¼ˆä¸æ¶‰åŠ Node/Electron API æ—¶ä½¿ç”¨ï¼‰ã€‚*
- **Reset**: `npm run dev:force`
    - *è¡Œä¸º: æ¸…é™¤ Vite/Electron ç¼“å­˜å¹¶å¼ºåˆ¶é‡å¯ã€‚*

### ç”Ÿäº§æ„å»º (Production Build)
- **Web Build**: `npm run build:web`
- **Electron (Windows)**: `npm run build:electron:win`
- **Electron (macOS)**: `npm run build:electron:mac`
- **Electron (Linux)**: `npm run build:electron:linux`

### ä¾èµ–ç®¡ç† (Dependencies)
- **å®‰è£…ä¾èµ–**: `npm install`
- **æ·»åŠ ä¾èµ–**: `npm install [package]` (æˆ– `--save-dev`)
    - *âš ï¸ è­¦å‘Š*: å¦‚æœæ·»åŠ äº† Native æ¨¡å— (å¦‚ sqlite3, serialport)ï¼Œå®‰è£…åå¯èƒ½éœ€è¦é‡æ–°ç¼–è¯‘ native bindingsã€‚

## 4. ğŸ“ ä»£ç é£æ ¼åå¥½ (CODING STYLE)

### Vue ç»„ä»¶è§„èŒƒ

- **ä½¿ç”¨ Vue 3 Composition API** + `<script setup lang="ts">`
  - æ‰€æœ‰æ–°ç»„ä»¶å¿…é¡»ä½¿ç”¨ `<script setup lang="ts">` è¯­æ³•
  - é¿å…ä½¿ç”¨ Options API æˆ– `defineComponent`
  - ä½¿ç”¨ `ref()` å’Œ `computed()` ç®¡ç†å“åº”å¼çŠ¶æ€

```vue
<script setup lang="ts">
import { ref, computed, onMounted } from 'vue'
import { useRouter } from 'vue-router'
import { ElMessage } from 'element-plus'

const loading = ref(false)
const router = useRouter()
</script>

<style scoped>
/* ä½¿ç”¨ scoped CSSï¼Œé¿å…å…¨å±€æ ·å¼æ±¡æŸ“ */
</style>
```

### TypeScript è§„èŒƒ

- **Interface vs Type**ï¼š
  - å¤æ‚å¯¹è±¡ã€ç±»ã€å‡½æ•°ç­¾å â†’ ä½¿ç”¨ `interface`
  - è”åˆç±»å‹ã€å­—é¢é‡ç±»å‹ â†’ ä½¿ç”¨ `type`

```typescript
// âœ… Interface ç”¨äºå¯¹è±¡
interface Student {
  id: number
  name: string
  gender: 'ç”·' | 'å¥³'
  birthday: string
}

// âœ… Type ç”¨äºè”åˆç±»å‹
type ScaleType = 'sm' | 'weefim' | 'csirs' | 'conners-psq' | 'conners-trs'
```

- **Props å®šä¹‰**ï¼šä½¿ç”¨ `defineProps<T>()` æ³›å‹è¯­æ³•

```typescript
interface Props {
  studentId: number
  readonly?: boolean
}
const props = defineProps<Props>()
```

### æ ·å¼è§„èŒƒ

- **ä»…ä½¿ç”¨ Scoped CSS**ï¼š`<style scoped>`
- **ç¦æ­¢ä½¿ç”¨**ï¼šTailwindã€UnoCSSã€CSS Modulesã€SCSS
- **æ ·å¼éš”ç¦»**ï¼šæ‰€æœ‰ç»„ä»¶æ ·å¼å¿…é¡»ä½¿ç”¨ `scoped` é¿å…æ±¡æŸ“å…¨å±€

### ç›®å½•ç»“æ„è§„èŒƒ

```
src/
â”œâ”€â”€ views/assessment/        # è¯„ä¼°æ¨¡å—ï¼ˆæŒ‰åŠŸèƒ½åˆ†ç»„ï¼‰
â”‚   â”œâ”€â”€ conners-psq/        # PSQ è¯„ä¼°
â”‚   â”œâ”€â”€ conners-trs/        # TRS è¯„ä¼°
â”‚   â””â”€â”€ csirs/              # CSIRS è¯„ä¼°
â”œâ”€â”€ stores/                 # Pinia çŠ¶æ€ç®¡ç†
â”œâ”€â”€ types/                  # TypeScript ç±»å‹å®šä¹‰
â”œâ”€â”€ database/               # æ•°æ®åº“ç›¸å…³
â””â”€â”€ utils/                  # å·¥å…·å‡½æ•°
```

### çŠ¶æ€ç®¡ç†

- **ä»…ä½¿ç”¨ Pinia**ï¼šç¦æ­¢ä½¿ç”¨ Vuex
- Store å®šä¹‰ä½¿ç”¨ `setup` è¯­æ³•ï¼š

```typescript
export const useStudentStore = defineStore('student', () => {
  const students = ref<Student[]>([])
  const loadStudents = async () => { /* ... */ }
  return { students, loadStudents }
})
```

### ä¾èµ–åº“è§„èŒƒ

| ç”¨é€” | ä½¿ç”¨ | ç¦æ­¢ä½¿ç”¨ |
| :--- | :--- | :--- |
| UI ç»„ä»¶åº“ | Element Plus | - |
| å›¾è¡¨ | ECharts | Chart.js, D3 |
| çŠ¶æ€ç®¡ç† | Pinia | Vuex |
| å·¥å…·å‡½æ•° | åŸç”Ÿ API | lodash, underscore |
| è·¯ç”± | Vue Router | - |

### å‘½åè§„èŒƒ

- **ç»„ä»¶æ–‡ä»¶**ï¼šPascalCase (ä¾‹ï¼š`AssessmentSelect.vue`)
- **å·¥å…·å‡½æ•°**ï¼šcamelCase (ä¾‹ï¼š`calculateAge()`)
- **å¸¸é‡**ï¼šSCREAMING_SNAKE_CASE (ä¾‹ï¼š`MAX_SCORE`)
- **ç±»å‹/æ¥å£**ï¼šPascalCase (ä¾‹ï¼š`interface Student`)

### ä»£ç ç»„ç»‡åŸåˆ™

1. **å•ä¸€èŒè´£**ï¼šæ¯ä¸ªç»„ä»¶/å‡½æ•°åªåšä¸€ä»¶äº‹
2. **DRY**ï¼šé¿å…é‡å¤ä»£ç ï¼ŒæŠ½å–å…¬å…±é€»è¾‘åˆ° `utils/`
3. **YAGNI**ï¼šä¸è¿‡åº¦è®¾è®¡ï¼Œåªå®ç°å½“å‰éœ€è¦çš„åŠŸèƒ½
4. **æ¨¡å—åŒ–**ï¼šæŒ‰åŠŸèƒ½åˆ†ç»„ï¼Œè€ŒéæŒ‰æ–‡ä»¶ç±»å‹

### é€šç”¨è§„èŒƒ

- **å¼‚æ­¥å¤„ç†**ï¼šä¼˜å…ˆä½¿ç”¨ `async/await`ï¼Œé¿å…å›è°ƒåœ°ç‹±
- **é”™è¯¯å¤„ç†**ï¼šåœ¨ IPC é€šä¿¡å’Œåç«¯ API ä¸­å¿…é¡»åŒ…å« try/catch å—
- **è·¯å¾„å¼•ç”¨**ï¼šä½¿ç”¨ `@/` åˆ«åå¼•ç”¨ `src/` ç›®å½•
