# 生活自理适应综合训练系统 PRD

## 1. 产品概述

### 1.1 产品背景
生活自理适应综合训练系统是一款专为特殊教育学校设计的软件，用于评估和训练学生的生活自理能力。该系统基于S-M量表（婴儿-初中生社会生活能力量表）和WeeFIM量表（改良儿童功能独立性评估量表），通过电子化评估和个性化训练，帮助学生提高生活自理能力，促进其全面发展。

### 1.2 产品目标
- 实现S-M量表和WeeFIM量表的电子化评估，提高评估效率和准确性
- 生成个性化训练计划，支持学生针对性训练
- 建立学生评估和训练档案，支持历史数据查询和分析
- 提供丰富的训练资源，支持多种训练方式
- 生成专业评估报告，支持导出和打印

## 2. 功能需求

### 2.1 系统管理
- **用户管理**：支持教师、管理员等角色管理
- **权限管理**：基于角色的权限控制
- **系统设置**：支持系统参数配置
- **账号本地加密**：用户账号密码本地加密存储，保障数据安全
- **学生建档**：支持拍照上传学生照片，支持批量Excel导入学生信息
- **一键备份/恢复**：支持系统数据的一键备份和恢复功能

### 2.1.1 软件激活与加密（★安全性核心）
- **试用期机制**：首次使用提供7天免费试用，无需激活
- **激活码验证**：支持离线激活码验证，使用RSA-2048数字签名
- **机器码绑定**：激活码绑定设备机器码（CPU+主板），宽松容忍度60%
- **永久/限时激活**：支持永久激活和限时激活（如365天、730天等）
- **本地加密存储**：激活数据使用AES-256加密 + HMAC-SHA256防篡改存储
- **激活状态提示**：显示激活状态、试用剩余天数、激活有效期
- **激活对话框**：在试用期和激活码管理界面输入激活码

**激活流程**：
1. 应用首次启动 → 检查激活状态
2. 试用期内可跳过激活，继续使用
3. 试用期结束 → 强制显示激活对话框
4. 用户输入激活码 → RSA签名验证 → 机器码匹配验证
5. 验证成功 → AES加密存储 → 激活完成

### 2.2 学生管理
- **学生信息管理**：支持学生基本信息的增删改查
- **学生档案管理**：建立学生完整档案，包括评估历史、训练记录等
- **学生分组管理**：支持按班级、年龄、障碍类型等分组

### 2.3 评估模块
- **量表选择**：支持S-M量表、WeeFIM量表和26项生活自理量表切换
- **S-M量表评估**：基于S-M量表的132道题目（5个维度）进行评估
- **WeeFIM量表评估**：基于WeeFIM量表的18个项目（2大领域）进行评估
- **26项生活自理评估**：基于26项标准化生活自理任务评估（详见2.3.3节）
- **年龄阶段自动判断**：根据学生年龄自动确定评估阶段（仅S-M量表）
- **评估流程管理**：支持评估答题、结果计算、报告生成
- **评估结果管理**：支持评估结果的查询、统计和分析
- **语音读题**：支持播放题目语音，辅助学生理解题目
- **中断续做**：支持评估过程中断后继续评估
- **SQ计算**：自动生成SQ（社会商）与等级：正常≥10、边缘8-9、异常≤7（仅S-M量表）
- **WeeFIM评分**：自动计算总分、ADL得分和认知得分，划分功能独立性等级
- **IEP目标推荐**：根据缺陷维度自动推荐IEP目标，支持教师修改

#### 2.3.3 26项生活自理评估量表（规划中）
基于《26项生活自理任务标准化评估量表设计》，实现特殊儿童生活自理能力的标准化评估。

**评估范围**：
- **饮食技能（2项）**：用勺子吃饭、用筷子吃饭
- **个人卫生（7项）**：洗手、挤牙膏、刷牙、洗脸、梳头、擦鼻涕、洗澡
- **穿着技能（7项）**：穿衣服、脱衣服、穿裤子、脱裤子、穿袜子、穿鞋子、系鞋带
- **如厕技能（3项）**：上厕所小便（男）、上厕所小便（女）、上厕所（大便）
- **居家生活（5项）**：收拾书包、整理床铺、擦桌子、扫地、洗澡
- **社区生活（2项）**：超市购物、乘坐公交车

**评分系统**：
采用**0-4五级评分制**：
- **4分**：独立完成（100%自主）
- **3分**：语言提示（1-2次口头提醒）
- **2分**：手势/示范提示
- **1分**：肢体辅助（手把手帮助）
- **0分**：完全依赖（无法完成或拒绝）

**特色功能**：
- **自动评估**：基于训练数据自动评分（需有训练记录）
- **手动评估**：支持教师手动评分
- **可信度计算**：自动评估结果显示可信度百分比
- **雷达图展示**：6大领域得分可视化
- **综合分析**：优势领域识别、待提升领域识别
- **IEP目标生成**：根据评估结果自动生成训练建议

### 2.4 训练任务模块（★本期核心扩充）

#### 2.4.1 分类与能力项
| 一级分类 | 关键能力动作 | 前期任务清单（每任务3-4级难度） | 媒体类型 |
|---|---|---|---|
| 饮食能力 | 吸吮、合唇、喝、咀嚼、吞咽、使用餐具、收拾餐具 | 1. 用吸管喝水<br>2. 用勺子吃米饭<br>3. 剥香蕉皮<br>4. 开午餐盒盖<br>5. 端汤碗行走 | 图示+3-5秒静音视频 |
| 如厕能力 | 如厕技能、便后清洁、冲水、提裤、区分男女厕 | 1. 男生如厕5步<br>2. 女生如厕5步<br>3. 便后擦拭（臀前→后）<br>4. 冲水+提裤 | 同上（真人打码） |
| 穿着能力 | 脱衣、穿衣、拉拉链、扣纽扣、系鞋带、戴帽子、整理衣物 | 1. 脱/穿T恤<br>2. 穿外套<br>3. 拉拉链<br>4. 系鞋带单结<br>5. 戴魔术贴鞋 | 同上 |
| 清洁（梳洗）能力 | 擦、刷、洗、头发护理、拧毛巾、挂毛巾 | 1. 洗手7步（WHO）<br>2. 刷牙12步<br>3. 擦鼻涕<br>4. 洗脸8步<br>5. 拧毛巾+挂好 | 3D动画/真人 |
| 睡眠能力 | 入睡、整理床铺、穿脱睡衣、安静躺卧 | 1. 穿睡衣裤<br>2. 叠被子<br>3. 安静躺下闭眼 | 图示 |
| 其他日常家居 | 物品归位、开关灯/门、收纳玩具、端托盘、扔垃圾 | 1. 收拾餐具到水池<br>2. 玩具归位箱<br>3. 开关门把手<br>4. 扔垃圾入桶 | 图示 |

#### 2.4.2 任务通用规则
- **任务组成**：每任务含封面图、步骤图、步骤视频（≤3 MB，3-5秒静音循环）、语音提示（mp3）
- **难度分级**：L1 2-3步→L2 4-6步→L3 7-10步→L4 11-15步（视任务可缺L4）
- **学生端体验**：全屏无菜单，触屏"完成"进入下一步；可重播语音/视频
- **数据采集**：记录start_time、end_time、total_step、finish_step、error_type（0正常 1跳过 2顺序错 3超时>30s）、score（0-100）

#### 2.4.3 任务编辑器（教师用）
- **视频替换**：可替换本校真人示范视频（一键1280×800裁剪、≤3 MB压缩）
- **媒体类型切换**：可切换"仅图 / 图+视频 / 仅视频"
- **内容编辑**：步骤文字、语音可改；支持批量导入zip包（图+视频同名）

#### 2.4.4 训练计划生成
- **个性化推荐**：根据评估结果生成个性化训练计划
- **计划调整**：支持教师调整训练计划
- **进度跟踪**：实时跟踪训练进度，支持查看训练记录

### 2.5 资源库
- **本地资源存储**：本地文件夹`/resources/`：教学文档30、示范长视频20、PPT课件10、案例分析15
- **资源管理**：支持视频、音频、图片等资源的上传、管理和分类
- **资源搜索**：侧边栏6分类树形+关键词搜索
- **资源打开**：双击调用系统默认程序打开资源
- **资源收藏**：支持教师收藏常用资源
- **资源推荐**：根据学生评估结果推荐相关资源

### 2.6 报告生成
- **评估报告**：生成S-M量表、WeeFIM量表和26项生活自理量表评估报告
- **训练报告**：生成学生训练效果报告
- **综合报告**：生成学生综合发展报告，支持三大评估结果对比分析
- **报告导出**：支持PDF、Word等格式导出

## 3. 用户角色与权限

### 3.1 用户角色定义

系统面向特殊教育学校和普校资源教室，设置两个主要用户角色：

#### 3.1.1 管理员（Administrator）
**主要职责**：系统维护和学生信息管理

**权限清单**：
- ✅ 用户账号管理（新增、编辑、删除教师和管理员账号）
- ✅ 权限分配和管理
- ✅ 系统配置（参数设置、系统初始化）
- ✅ 学生批量导入（支持Excel批量导入）
- ✅ 学生信息管理（新增、编辑、删除）
- ✅ 拍照上传学生头像
- ✅ 系统数据备份和恢复
- ✅ 操作日志查看
- ✅ 系统日志管理

#### 3.1.2 教师（Teacher）
**主要职责**：学生评估、训练计划制定和教学资源管理

**权限清单**：
- ✅ 新增学生信息（单个录入）
- ✅ 编辑学生信息（自己负责的学生）
- ✅ 拍照上传学生头像
- ✅ 查看学生档案和历史数据
- ✅ 进行学生评估（S-M量表、WeeFIM量表）
- ✅ 查看评估结果和生成报告
- ✅ 创建和调整训练计划
- ✅ 编辑训练任务（替换视频、调整内容、切换媒体类型）
- ✅ 查看学生训练记录和进度
- ✅ 生成训练报告和综合报告
- ✅ 资源库搜索和收藏
- ❌ 删除学生信息
- ❌ 系统配置和维护
- ❌ 数据备份和恢复

#### 3.1.3 学生使用方式（无需账号登录）
- 学生不需要单独账号，由教师登录系统后为其进行操作
- 教师选择学生后，学生可进行：
  - 参加评估答题
  - 完成训练任务（全屏无菜单模式）
  - 查看示范视频和图片资源
- 系统自动记录学生的所有操作和学习数据

### 3.2 权限矩阵

| 功能模块 | 管理员 | 教师 |
|---------|--------|------|
| **用户管理** | | |
| 账号新增/编辑/删除 | ✅ | ❌ |
| 权限分配 | ✅ | ❌ |
| **学生管理** | | |
| 批量导入学生 | ✅ | ❌ |
| 新增学生 | ✅ | ✅ |
| 编辑学生信息 | ✅ | ✅ |
| 删除学生 | ✅ | ❌ |
| 上传学生头像 | ✅ | ✅ |
| **评估管理** | | |
| 进行学生评估 | ✅ | ✅ |
| 查看评估结果 | ✅ | ✅ |
| 生成评估报告 | ✅ | ✅ |
| **训练管理** | | |
| 创建训练计划 | ✅ | ✅ |
| 调整训练计划 | ✅ | ✅ |
| 编辑训练任务 | ✅ | ✅ |
| 查看训练记录 | ✅ | ✅ |
| 生成训练报告 | ✅ | ✅ |
| **资源管理** | | |
| 资源搜索/查看 | ✅ | ✅ |
| 资源收藏 | ✅ | ✅ |
| **系统管理** | | |
| 系统参数配置 | ✅ | ❌ |
| 数据备份/恢复 | ✅ | ❌ |
| 查看操作日志 | ✅ | ❌ |
| **激活管理** | | |
| 软件激活 | ✅ | ✅ |
| 查看激活状态 | ✅ | ✅ |
| 管理激活码 | ✅ | ❌ |

## 4. 系统架构设计

### 4.1 应用架构类型
- **桌面应用**：基于Electron框架，支持Windows、macOS、Linux操作系统
- **离线优先**：所有数据存储在本地SQL.js数据库，支持完全离线使用
- **单机部署**：适合学校本地使用，无需网络连接

### 4.2 系统整体流程

```
┌─────────────────────────────────────────────────────┐
│          应用启动                                    │
│  ├─ 初始化SQL.js数据库                             │
│  ├─ 检查用户登录状态                               │
│  └─ 加载用户权限配置                               │
└──────────────┬──────────────────────────────────────┘
               │
         ┌─────▼─────┐
         │ 登录界面   │
         │ 账号密码   │
         │ （本地加密）│
         └─────┬─────┘
               │
    ┌──────────┴──────────┐
    │                     │
┌───▼────────┐      ┌───▼──────────┐
│ 管理员界面  │      │ 教师界面      │
│ ├─用户管理  │      │ ├─学生管理    │
│ ├─学生管理  │      │ ├─评估管理    │
│ ├─系统配置  │      │ ├─训练管理    │
│ ├─数据备份  │      │ ├─资源库      │
│ └─操作日志  │      │ └─报告生成    │
└────────────┘      └───┬──────────┘
                        │
                    ┌───▼──────────┐
                    │ 学生操作界面  │
                    │ ├─评估答题    │
                    │ ├─训练执行    │
                    │ └─资源查看    │
                    │ （全屏无菜单）│
                    └───────────────┘
```

### 4.3 核心业务流程

#### 4.3.1 学生评估流程（教师端）
```
选择学生 → 选择量表 → 自动判断年龄阶段 → 答题 → 结果计算 → 报告生成 → 生成IEP目标建议
```

#### 4.3.2 学生训练流程（教师端）
```
创建训练计划 → 选择训练任务 → 学生执行训练 → 系统记录数据 → 生成训练报告 → 效果分析
```

#### 4.3.3 学生使用流程（学生端）
```
教师选择 → 全屏无菜单界面 → 查看题目/步骤 → 触屏交互 → 完成记录 → 返回主界面
```

### 4.4 激活系统架构（★安全性核心）

#### 4.4.1 激活流程

```
应用首次启动
  ↑
检查激活状态
  ↑
  ┌───────────────┬───────────┬───────────┐
  │ 已激活且有效   │   试用期内    │ 试用期已过旧   │
  ├───────────────┴───────────┴───────────┘
  │ 正常使用  │显示激活对话框  │显示激活对话框   │
  │          │（可跳过）  │（不可跳过）   │
  └──────────────────────────────────────┴───────────────────────┘
                        ↑
                  用户输入激活码
                        ↑
              反格式化 → Base64解码
                        ↑
               分离数据和RSA签名
                        ↑
              ┌──────────┐
              │  RSA公钥验证   │
              └──────────┘
                ↑           ↑
              成功         失败
                ↑           ↑
          验证机器码     提示错误
          匹配度60%
                ↑
          检查过期时间
                ↑
        AES加密存储到本地
                ↑
          添加HMAC签名
                ↑
            激活成功
```

#### 4.4.2 激活码签名验证

激活系统使用RSA-2048数字签名：
- **签名算法**：SHA-256 + RSA签名
- **激活码供成**：4字节数据长度 + JSON数据 + RSA签名
- **验证方法**：客户端使用公钥验证签名

#### 4.4.3 机器码绑定

激活码需要绑定机器码，来源：
- **来源**：CPU信息 + 主松信息（使用node-machine-id库）
- **傧科**：SHA-256傧科后取前16位
- **容忍度**：60%（允许更换内存等不是核心硬件）

#### 4.4.4 本地加密存储

激活成功后，使用AES-256加密 + HMAC-SHA256方法存储：
- **库**：electron-store
- **存储位置**：
  - Windows: `C:\Users\<用户名>\AppData\Roaming\special-edu-safe\license-data.json`
  - macOS: `~/Library/Application Support/special-edu-safe/license-data.json`
  - Linux: `~/.config/special-edu-safe/license-data.json`
- **存储结构**：JSON文件（激活数据加密 + HMAC签名）

#### 4.4.5 试用期管理

- **试用时长**：7天
- **记录方法**：记录首次运行时间戳
- **试用期内行为**：可正常使用所有功能、可跳过激活提示
- **试用期结束**：强制显示激活对话框，不可跳过

#### 4.4.6 激活管理界面

**管理员权限**：
- 预判激活码（事先生成，用于销售）
- 生成正式激活码（需要机器码）
- 查看激活历史
- 管理已激活设备

**教师/管理员共同权限**：
- 查看激活状态
- 输入激活码
- 验证激活码
- 上传激活码

## 5. 非功能需求

### 5.1 性能需求
- 系统响应时间<2秒
- 支持同时100+用户在线
- 数据存储容量支持10000+学生数据

### 5.2 安全性需求
- 数据加密存储
- 权限控制严格
- 操作日志记录

### 5.3 易用性需求
- 界面简洁直观
- 操作流程简单
- 支持键盘导航
- 支持语音读题

### 5.4 兼容性需求
- 支持主流浏览器（Chrome、Firefox、Safari、Edge）
- 支持Windows、macOS、Linux等操作系统
- 支持平板设备

### 5.5 可维护性需求
- 代码结构清晰，易于维护
- 完善的文档
- 模块化设计，支持功能扩展

## 6. 技术架构

### 6.1 技术栈
- **前端框架**：Vue 3 + Vite
- **路由管理**：Vue Router
- **状态管理**：Pinia（可选）
- **数据库**：SQL.js（纯JavaScript SQLite）
- **构建工具**：Vite
- **样式**：CSS3 + SCSS
- **桌面支持**：Electron（可选）

### 6.2 架构设计
- 采用前后端分离架构
- 前端使用Vue 3组件化开发
- 数据存储使用SQL.js，支持离线使用
- 模块化设计，功能模块清晰分离

## 7. 数据模型

### 7.1 核心表结构

#### 7.1.1 学生表（student）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 学生ID，主键 |
| name | TEXT | 学生姓名 |
| gender | TEXT | 性别 |
| birthday | TEXT | 出生日期 |
| student_no | TEXT | 学号 |
| disorder | TEXT | 障碍类型 |
| avatar_path | TEXT | 头像路径 |
| created_at | TEXT | 创建时间 |

#### 7.1.2 S-M量表年龄阶段表（sm_age_stage）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 阶段ID，主键 |
| name | TEXT | 阶段名称 |
| age_min | INTEGER | 最小月龄 |
| age_max | INTEGER | 最大月龄 |

#### 7.1.3 S-M量表题目表（sm_question）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 题目ID，主键 |
| dimension | TEXT | 所属维度 |
| age_stage | INTEGER | 所属年龄阶段 |
| age_min | INTEGER | 适用最小月龄 |
| age_max | INTEGER | 适用最大月龄 |
| title | TEXT | 题目内容 |
| audio | TEXT | 音频路径 |

#### 7.1.4 S-M量表常模表（sm_norm）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 常模ID，主键 |
| age_month | INTEGER | 月龄 |
| mean | REAL | 均值 |
| sd | REAL | 标准差 |

#### 7.1.5 粗分-标准分换算表（sm_raw_to_sq）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 换算ID，主键 |
| raw_score | INTEGER | 粗分 |
| sq_score | INTEGER | 标准分(SQ) |
| level | TEXT | 等级 |

#### 7.1.6 评估主表（sm_assess）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 评估ID，主键 |
| student_id | INTEGER | 学生ID，外键 |
| raw_score | INTEGER | 粗分 |
| sq_score | INTEGER | 标准分(SQ) |
| level | TEXT | 等级 |
| created_at | TEXT | 评估时间 |

#### 7.1.7 评估详情表（sm_assess_detail）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 详情ID，主键 |
| assess_id | INTEGER | 评估ID，外键 |
| question_id | INTEGER | 题目ID，外键 |
| score | INTEGER | 得分(0或1) |

#### 7.1.8 训练任务表（task）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 任务ID，主键 |
| code | TEXT | 任务代码 |
| name | TEXT | 任务名称 |
| category | INTEGER | 一级分类ID |
| ability_item | TEXT | 关键能力动作 |
| media_type | TEXT | 媒体类型（图示/视频/3D动画） |
| cover_img | TEXT | 封面图路径 |
| created_at | TEXT | 创建时间 |
| updated_at | TEXT | 更新时间 |

#### 7.1.9 训练任务难度表（task_level）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 难度ID，主键 |
| task_id | INTEGER | 任务ID，外键 |
| level | INTEGER | 难度等级（1-4） |
| total_step | INTEGER | 总步骤数 |
| score | INTEGER | 满分分数 |
| created_at | TEXT | 创建时间 |
| updated_at | TEXT | 更新时间 |

#### 7.1.10 训练任务步骤表（task_step）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 步骤ID，主键 |
| task_id | INTEGER | 任务ID，外键 |
| level_id | INTEGER | 难度ID，外键 |
| seq | INTEGER | 步骤顺序 |
| img_path | TEXT | 图片路径 |
| video_path | TEXT | 视频路径 |
| audio_path | TEXT | 音频路径 |
| text | TEXT | 步骤描述 |
| created_at | TEXT | 创建时间 |
| updated_at | TEXT | 更新时间 |

#### 7.1.11 训练记录表（train_log）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 记录ID，主键 |
| student_id | INTEGER | 学生ID，外键 |
| task_id | INTEGER | 任务ID，外键 |
| level_id | INTEGER | 难度ID，外键 |
| level | INTEGER | 难度等级 |
| start_time | TEXT | 开始时间 |
| end_time | TEXT | 结束时间 |
| total_step | INTEGER | 总步骤数 |
| finish_step | INTEGER | 完成步骤数 |
| score | INTEGER | 得分（0-100） |
| error_type | INTEGER | 错误类型（0正常 1跳过 2顺序错 3超时>30s） |
| created_at | TEXT | 创建时间 |

#### 7.1.12 训练计划主表（train_plan）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 计划ID，主键 |
| student_id | INTEGER | 学生ID，外键 |
| name | TEXT | 计划名称 |
| start_date | TEXT | 开始日期 |
| end_date | TEXT | 结束日期 |
| status | INTEGER | 状态（0未开始 1进行中 2已完成） |
| created_at | TEXT | 创建时间 |
| updated_at | TEXT | 更新时间 |

#### 7.1.13 训练计划详情表（train_plan_detail）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 计划详情ID，主键 |
| plan_id | INTEGER | 计划ID，外键 |
| task_id | INTEGER | 任务ID，外键 |
| level_id | INTEGER | 难度ID，外键 |
| scheduled_date | TEXT | 计划执行日期 |
| actual_date | TEXT | 实际执行日期 |
| status | INTEGER | 状态（0未执行 1已执行 2已完成） |
| score | INTEGER | 得分 |
| created_at | TEXT | 创建时间 |
| updated_at | TEXT | 更新时间 |

#### 7.1.14 训练任务分类表（task_category）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 分类ID，主键 |
| name | TEXT | 分类名称 |
| parent_id | INTEGER | 父分类ID（0为一级分类） |
| description | TEXT | 分类描述 |
| created_at | TEXT | 创建时间 |
| updated_at | TEXT | 更新时间 |

#### 7.1.15 资源表（resource_meta）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 资源ID，主键 |
| title | TEXT | 资源标题 |
| type | TEXT | 资源类型 |
| category | INTEGER | 资源类别 |
| path | TEXT | 资源路径 |
| size_kb | INTEGER | 资源大小(KB) |
| tags | TEXT | 资源标签 |
| created_at | TEXT | 创建时间 |
| updated_at | TEXT | 更新时间 |

#### 7.1.16 教师收藏表（teacher_fav）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 收藏ID，主键 |
| teacher_id | INTEGER | 教师ID |
| resource_id | INTEGER | 资源ID，外键 |
| created_at | TEXT | 收藏时间 |

#### 7.1.17 WeeFIM量表分类表（weefim_category）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 分类ID，主键 |
| name | TEXT | 分类名称 |
| description | TEXT | 分类描述 |

#### 7.1.18 WeeFIM量表题目表（weefim_question）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 题目ID，主键 |
| category_id | INTEGER | 分类ID，外键 |
| title | TEXT | 题目内容 |
| dimension | TEXT | 所属维度 |
| audio | TEXT | 音频路径 |

#### 7.1.19 WeeFIM量表评估主表（weefim_assess）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 评估ID，主键 |
| student_id | INTEGER | 学生ID，外键 |
| total_score | INTEGER | 总分（18-126分） |
| adl_score | INTEGER | 日常生活活动得分 |
| cognitive_score | INTEGER | 认知功能得分 |
| level | TEXT | 功能独立性等级 |
| created_at | TEXT | 评估时间 |

#### 7.1.20 WeeFIM量表评估详情表（weefim_assess_detail）
| 字段名 | 数据类型 | 描述 |
|--------|----------|------|
| id | INTEGER | 详情ID，主键 |
| assess_id | INTEGER | 评估ID，外键 |
| question_id | INTEGER | 题目ID，外键 |
| score | INTEGER | 得分（1-7分） |

## 8. S-M量表评估流程

### 8.1 评估阶段划分
S-M量表评估分为7个年龄阶段：
1. 6个月-1岁11个月
2. 2岁-3岁5个月
3. 3岁6个月-4岁11个月
4. 5岁-6岁5个月
5. 6岁6个月-8岁5个月
6. 8岁6个月-10岁5个月
7. 10岁6个月以上

### 8.2 评估方法
1. **起始点确定**：根据学生年龄确定评估起始阶段
2. **评估流程**：
   - 从起始阶段开始提问
   - 如连续10项通过，则认为之前的项目均已通过
   - 继续向下提问，直至连续10项不能通过，则认为之后的项目均不能通过
   - 如开始10项未能全部通过，应继续向前提问，直至连续10项均能通过
3. **评分标准**：
   - 通过：得1分
   - 不通过：得0分
4. **评估功能**：
   - 语音读题：支持播放题目语音，辅助学生理解题目
   - 中断续做：支持评估过程中断后继续评估

### 8.3 结果计算
1. **粗分**：所有通过项目的得分总和
2. **标准分(SQ)**：根据粗分和常模数据计算得出
3. **等级划分**：
   - 正常：SQ ≥ 10
   - 边缘：8 ≤ SQ < 10
   - 异常：SQ < 8
4. **IEP目标推荐**：根据缺陷维度自动推荐IEP目标，支持教师修改

### 8.4 评估报告
- 生成S-M量表评估报告
- 支持PDF、Word等格式导出
- 包含学生基本信息、评估结果、等级划分、IEP目标建议等内容

## 9. WeeFIM量表评估流程

### 9.1 WeeFIM量表概述
WeeFIM量表（改良儿童功能独立性评估量表）是专门为儿童设计的功能评估工具，旨在全面、客观地衡量儿童在日常生活活动、认知及社会功能等方面的独立能力。量表包含18个评估项目，分为日常生活活动（ADL）和认知功能两大领域。

### 9.2 评估领域与项目

#### 9.2.1 日常生活活动（ADL）领域
- **自我照顾**：进食、梳洗修饰、洗澡、穿上衣、穿下衣、如厕
- **括约肌控制**：排尿控制、排便控制
- **转移**：床椅转移、轮椅转移、进出浴盆/淋浴间
- **行走/移动**：步行、使用轮椅

#### 9.2.2 认知功能领域
- **沟通**：理解、表达
- **社会认知**：社会交往、解决问题

### 9.3 评估方法
1. **评估流程**：
   - 从第一个项目开始，依次进行所有18个项目的评估
   - 每个项目根据儿童的实际表现进行评分
2. **评分标准**：
   - 7分：完全独立，无需他人协助
   - 6分：有条件独立，需要辅助设备或少量帮助
   - 5分：监护或示范，需要他人监护或示范
   - 4分：最小量接触性协助，需要他人少量身体协助
   - 3分：中等量接触性协助，需要他人较多身体协助
   - 2分：最大量接触性协助，需要他人大量身体协助
   - 1分：完全依赖，完全依赖他人完成
3. **评估功能**：
   - 语音读题：支持播放题目语音，辅助学生理解题目
   - 中断续做：支持评估过程中断后继续评估

### 9.4 结果计算
1. **总分**：所有项目的得分总和（18-126分）
2. **ADL得分**：日常生活活动领域所有项目的得分总和
3. **认知得分**：认知功能领域所有项目的得分总和
4. **等级划分**：
   - 极强：总分 ≥ 108
   - 良好：90 ≤ 总分 < 108
   - 中等：72 ≤ 总分 < 90
   - 较弱：54 ≤ 总分 < 72
   - 非常弱：36 ≤ 总分 < 54
   - 极度弱：总分 < 36
5. **IEP目标推荐**：根据缺陷维度自动推荐IEP目标，支持教师修改

### 9.5 评估报告
- 生成WeeFIM量表评估报告
- 支持PDF、Word等格式导出
- 包含学生基本信息、评估结果（总分、ADL得分、认知得分）、等级划分、IEP目标建议等内容

## 10. 系统功能模块详细设计

### 10.1 登录模块
- 支持用户名密码登录
- 支持记住密码功能
- 支持密码重置功能

### 10.2 学生管理模块
- **学生列表**：展示所有学生信息，支持搜索和筛选
- **学生详情**：查看学生详细信息
- **学生添加**：添加新学生信息
- **学生编辑**：编辑学生信息
- **学生删除**：删除学生信息

### 10.3 评估模块
- **学生选择**：选择要评估的学生
- **量表选择**：选择S-M量表或WeeFIM量表进行评估
- **年龄阶段自动判断**：根据学生年龄自动确定评估阶段（仅S-M量表）
- **评估答题**：
  - S-M量表：展示题目，支持选择"通过"或"不通过"
  - WeeFIM量表：展示题目，支持1-7分的评分选择
- **语音读题**：支持播放题目语音，辅助学生理解题目
- **评估进度显示**：实时显示当前评估进度
- **评估结果计算**：
  - S-M量表：自动计算粗分、标准分(SQ)和等级
  - WeeFIM量表：自动计算总分、ADL得分、认知得分和功能独立性等级
- **评估结果保存**：保存评估结果到数据库
- **结果展示**：
  - S-M量表：展示原始分、SQ得分、等级和IEP目标建议
  - WeeFIM量表：展示总分、ADL得分、认知得分、等级和IEP目标建议

### 10.4 训练模块

#### 10.4.1 训练任务分类与能力项
- **饮食能力**：吸吮、合唇、喝、咀嚼、吞咽、使用餐具、收拾餐具
- **如厕能力**：如厕技能、便后清洁、冲水、提裤、区分男女厕
- **穿着能力**：脱衣、穿衣、拉拉链、扣纽扣、系鞋带、戴帽子、整理衣物
- **清洁（梳洗）能力**：擦、刷、洗、头发护理、拧毛巾、挂毛巾
- **睡眠能力**：入睡、整理床铺、穿脱睡衣、安静躺卧
- **其他日常家居**：物品归位、开关灯/门、收纳玩具、端托盘、擦桌子、扫地、拖地、扔垃圾、洗碗、洗衣服

#### 10.4.2 训练任务列表
- 展示所有训练任务，支持按类别筛选
- 显示任务名称、类别、难度等级等信息
- 支持搜索功能

#### 10.4.3 训练任务详情
- 查看任务详细信息和步骤
- 显示任务封面图、步骤图、视频等媒体资源
- 支持播放语音提示

#### 10.4.4 训练执行
- **学生端体验**：全屏无菜单，触屏"完成"进入下一步；可重播语音/视频
- **数据采集**：记录start_time、end_time、total_step、finish_step、error_type（0正常 1跳过 2顺序错 3超时>30s）、score（0-100）
- **训练过程**：按步骤引导学生完成训练任务

#### 10.4.5 任务编辑器（教师用）
- **视频替换**：可替换本校真人示范视频（一键1280×800裁剪、≤3 MB压缩）
- **媒体类型切换**：可切换"仅图 / 图+视频 / 仅视频"
- **内容编辑**：步骤文字、语音可改；支持批量导入zip包（图+视频同名）

#### 10.4.6 训练计划生成与管理
- **个性化推荐**：根据评估结果生成个性化训练计划
- **计划调整**：支持教师调整训练计划
- **进度跟踪**：实时跟踪训练进度，支持查看训练记录

#### 10.4.7 训练记录与分析
- 记录训练过程和结果
- 分析训练效果，生成训练报告
- 支持查看历史训练记录

### 10.5 资源库模块
- **本地资源存储**：本地文件夹`/resources/`：教学文档30、示范长视频20、PPT课件10、案例分析15
- **资源列表**：展示所有资源，支持搜索和筛选
- **资源分类**：侧边栏6分类树形结构
- **资源搜索**：支持关键词搜索
- **资源打开**：双击调用系统默认程序打开资源
- **资源详情**：查看资源详细信息
- **资源播放**：播放视频、音频等资源
- **资源收藏**：支持教师收藏常用资源
- **资源上传**：上传新资源

### 10.6 报告生成模块
- **评估报告**：生成S-M量表和WeeFIM量表评估报告
- **训练报告**：生成训练效果报告
- **综合报告**：生成学生综合发展报告
- **报告导出**：支持PDF、Word等格式导出
- **报告打印**：支持直接打印报告

## 11. 后续开发建议

### 11.1 数据导入
- 导入S-M量表132道题目数据
- 导入常模数据
- 导入粗分-标准分换算表

### 11.2 功能完善
- 实现语音读题功能
- 完善IEP目标智能生成功能
- 实现训练任务自动推荐功能
- 完善报告生成和导出功能

### 11.3 性能优化
- 优化数据库查询性能
- 优化页面加载速度
- 优化资源加载方式

### 11.4 测试与验证
- 功能测试
- 性能测试
- 兼容性测试
- 用户体验测试

### 11.5 文档完善
- 完善技术文档
- 完善用户手册
- 完善培训文档

## 12. 项目管理

### 12.1 开发流程
- 采用敏捷开发模式
- 两周一个迭代周期
- 定期召开站会和评审会议

### 12.2 代码管理
- 使用Git进行代码管理
- 采用分支开发策略
- 定期进行代码评审

### 12.3 测试管理
- 编写单元测试
- 编写集成测试
- 进行回归测试

### 12.4 部署管理
- 支持Docker部署
- 支持CI/CD
- 支持灰度发布

## 13. 风险评估

### 13.1 技术风险
- sql.js性能问题
- 浏览器兼容性问题
- 数据存储容量问题

### 13.2 数据风险
- 数据丢失风险
- 数据安全风险
- 数据准确性风险

### 13.3 进度风险
- 需求变更风险
- 技术难点风险
- 资源不足风险

### 15. 26项生活自理评估量表详细设计

#### 15.1 产品定位
26项生活自理评估量表是对现有S-M量表和WeeFIM量表的重要补充，专注于评估学生在具体生活自理任务中的实际表现。该量表的特点是：
- **任务导向**：直接评估26项具体的生活自理任务
- **实用性强**：评估结果直接关联IEP目标和训练计划
- **数据驱动**：可基于训练系统数据实现自动评估
- **标准化设计**：采用统一的0-4五级评分系统

#### 15.2 与现有评估的关系

| 对比维度 | S-M量表 | WeeFIM量表 | 26项生活自理量表 |
|---------|---------|-----------|-----------------|
| 评估重点 | 社会生活能力 | 功能独立性 | 具体自理任务执行 |
| 题目数量 | 132题 | 18题 | 26题 |
| 评分方式 | 通过/不通过 | 1-7分 | 0-4分 |
| 自动化程度 | 手动评估 | 手动评估 | 支持自动评估 |
| 与训练关联 | 间接关联 | 间接关联 | 直接关联 |

#### 15.3 核心功能需求

##### 15.3.1 自动评估算法
- **数据采集**：从训练记录中采集学生的完成度、独立性、一致性数据
- **评分转换**：将训练数据转换为0-4分评分
- **可信度计算**：基于训练次数、数据完整性、时间跨度计算可信度
- **人工校准**：支持教师对自动评估结果进行调整

##### 15.3.2 可视化分析
- **雷达图展示**：6大领域得分一目了然
- **进步追踪**：多次评估结果对比，显示进步曲线
- **领域对比**：识别优势和待提升领域
- **训练关联**：展示评估得分与训练表现的相关性

##### 15.3.3 IEP智能生成
- **模板库**：预置各领域的IEP目标模板
- **智能匹配**：根据评估结果自动匹配IEP目标
- **个性化调整**：支持教师根据实际情况调整目标
- **进度追踪**：IEP目标达成情况实时跟踪

#### 15.4 技术实现要点

##### 15.4.1 数据映射设计
建立26项评估任务与训练系统的映射关系：
- 直接映射：如"刷牙"评估直接对应"刷牙训练任务"
- 间接映射：如"社区生活"评估对应多个相关训练任务
- 无映射：某些评估项需要单独设计或手动评估

##### 15.4.2 评估算法优化
- **权重分配**：完成度40%、独立性40%、一致性20%
- **时间衰减**：近期训练数据权重更高
- **最小样本**：至少需要3次训练记录才进行自动评估
- **异常检测**：识别并处理异常的训练数据

#### 15.5 开发优先级
根据产品规划，26项生活自理评估量表的开发优先级为P4（延后开发），主要考虑：
1. 核心功能（S-M和WeeFIM评估）需要优先完善
2. 训练系统需要积累足够的训练数据
3. 自动评估算法需要充分测试和验证
4. 教师用户需要时间熟悉现有评估系统

#### 15.6 预期收益
- **评估效率提升**：自动评估减少教师工作量
- **评估准确性**：基于实际训练数据，评估结果更客观
- **IEP制定优化**：自动生成的IEP目标更具针对性
- **教学效果可视化**：清晰展示训练效果和进步轨迹

## 16. 结论

生活自理适应综合训练系统是一款专为特殊教育学校设计的软件，通过电子化评估和个性化训练，帮助学生提高生活自理能力。该系统基于S-M量表和WeeFIM量表，实现了评估流程的自动化和智能化，同时提供了丰富的训练资源和专业的报告生成功能。

系统采用Vue 3 + Vite + SQL.js技术栈，具有良好的性能和可扩展性。通过模块化设计，系统支持功能的灵活扩展和定制。

未来规划中的26项生活自理评估量表将进一步完善系统的评估能力，实现评估与训练的深度融合，为特殊儿童提供更加精准、个性化的教育支持。

后续开发将重点关注数据导入、功能完善、性能优化和测试验证等方面，确保系统能够满足特殊教育学校的实际需求，为学生的生活自理能力发展提供有力支持。